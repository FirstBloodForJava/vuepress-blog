import{_ as n,c as a,e,o as l}from"./app-DO9Fsueg.js";const t={};function p(i,s){return l(),a("div",null,s[0]||(s[0]=[e(`<h1 id="influxdb" tabindex="-1"><a class="header-anchor" href="#influxdb"><span>InfluxDB</span></a></h1><p>官网：https://www.influxdata.com/</p><p>InfluxDB是开源分布式时序、时间和指标数据库，使用Go语言编写，无需外部依赖。</p><h2 id="安装" tabindex="-1"><a class="header-anchor" href="#安装"><span>安装</span></a></h2><p>官网介绍文档：https://docs.influxdata.com/influxdb/v2/install/</p><h3 id="linux" tabindex="-1"><a class="header-anchor" href="#linux"><span>Linux</span></a></h3><p>Linux介绍了两种方式：</p><ul><li>方式一：安装InfluxDB作为系统服务</li><li>方式二：手动下载并安装二进制文件</li></ul><p>密钥对文件：</p><table><thead><tr><th>Private key file</th><th>Public key</th><th>支持系统</th></tr></thead><tbody><tr><td>influxdata-archive.key</td><td>943666881a1b8d9b849b74caebf02d3465d6beb716510d86a39f6c8e8dac7515</td><td>新</td></tr><tr><td>influxdata-archive_compat.key</td><td>393e8779c89ac8d958f81f942f9ad7fb82a25e133faddaf92e15b16e6ac9ce4c</td><td>旧</td></tr></tbody></table><p>方式一：</p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 需要找到对于Linux系统版本需要的 influxdata-archive.key</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--silent</span> <span class="token parameter variable">--location</span> <span class="token parameter variable">-O</span> <span class="token punctuation">\\</span></span>
<span class="line">https://repos.influxdata.com/influxdata-archive.key <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">echo</span> <span class="token string">&quot;943666881a1b8d9b849b74caebf02d3465d6beb716510d86a39f6c8e8dac7515  influxdata-archive.key&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> sha256sum <span class="token parameter variable">--check</span> - <span class="token operator">&amp;&amp;</span> <span class="token function">cat</span> influxdata-archive.key <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> gpg <span class="token parameter variable">--dearmor</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> <span class="token function">tee</span> /etc/pki/rpm-gpg/RPM-GPG-KEY-influxdata <span class="token operator">&gt;</span> /dev/null</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 将InfluxData存储库添加到YUM存储库列表中</span></span>
<span class="line"><span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">EOF<span class="token bash punctuation"> <span class="token operator">|</span> <span class="token function">tee</span> /etc/yum.repos.d/influxdata.repo</span></span>
<span class="line">[influxdata]</span>
<span class="line">name = InfluxData Repository - Stable</span>
<span class="line">baseurl = https://repos.influxdata.com/stable/<span class="token variable">\${basearch}</span>/main</span>
<span class="line">enabled = 1</span>
<span class="line">gpgcheck = 1</span>
<span class="line">gpgkey = file:///etc/pki/rpm-gpg/RPM-GPG-KEY-influxdata</span>
<span class="line">EOF</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 安装 influxdb</span></span>
<span class="line"><span class="token function">sudo</span> yum <span class="token function">install</span> influxdb2</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 启动(安装后会创建/lib/systemd/system/influxdb.service 服务文件)</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> influxdb start</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 查看状态</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">service</span> influxdb status</span>
<span class="line"><span class="token comment"># 成功则有以下输出</span></span>
<span class="line">influxdb.service - InfluxDB is an open-source, distributed, <span class="token function">time</span> series database</span>
<span class="line">   Loaded: loaded <span class="token punctuation">(</span>/lib/systemd/system/influxdb.service<span class="token punctuation">;</span> enabled<span class="token punctuation">;</span> vendor preset: enable<span class="token operator">&gt;</span></span>
<span class="line">   Active: active <span class="token punctuation">(</span>running<span class="token punctuation">)</span></span>
<span class="line">   </span>
<span class="line"></span>
<span class="line"><span class="token comment"># 传递启动参数</span></span>
<span class="line"><span class="token comment"># 编辑 /etc/default/influxdb2 服务配置文件</span></span>
<span class="line"><span class="token assign-left variable">ARG1</span><span class="token operator">=</span><span class="token string">&quot;--http-bind-address :8087&quot;</span></span>
<span class="line"><span class="token assign-left variable">ARG2</span><span class="token operator">=</span><span class="token string">&quot;--storage-wal-fsync-delay=15m&quot;</span></span>
<span class="line"><span class="token comment"># 编辑 /lib/systemd/system/influxdb.service 文件，将参数传给ExecStart</span></span>
<span class="line"><span class="token assign-left variable">ExecStart</span><span class="token operator">=</span>/usr/bin/influxd <span class="token variable">$ARG1</span> <span class="token variable">$ARG2</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>方式二：</p><p>根据<code>uname -m</code>命令结果选择压缩包</p><table><thead><tr><th>输出</th><th>架构</th><th>应下载包类型</th></tr></thead><tbody><tr><td>x86_64</td><td>64位 AMD/Intel</td><td>AMD64或x86_64</td></tr><tr><td>aarch64</td><td>64位 ARM</td><td>ARM64或aarch64</td></tr><tr><td>armv7l</td><td>32位 ARM</td><td>ARMv7（较少支持）</td></tr><tr><td>i686</td><td>32位 Intel</td><td>i386（非常旧）</td></tr></tbody></table><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 先下载系统需要的压缩包</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># curl 命令下载 amd64 方式</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token parameter variable">-O</span> <span class="token punctuation">\\</span></span>
<span class="line">https://download.influxdata.com/influxdb/releases/v2.7.12/influxdb2-2.7.12_linux_amd64.tar.gz</span>
<span class="line"><span class="token comment"># curl 命令下载 arm64 方式</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--location</span> <span class="token parameter variable">-O</span> <span class="token punctuation">\\</span></span>
<span class="line">https://download.influxdata.com/influxdb/releases/v2.7.12/influxdb2-2.7.12_linux_arm64.tar.gz</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 系统校验InfluxDB的密钥对</span></span>
<span class="line"><span class="token comment"># amd64 需要替换https://repos.influxdata.com/influxdata-archive.key 为密钥键(不确定是否能省略)</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--silent</span> <span class="token parameter variable">--location</span> https://repos.influxdata.com/influxdata-archive.key <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> gpg <span class="token parameter variable">--import</span> - <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;InfluxData Package Signing Key &lt;support@influxdata.com&gt;&#39;</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">&amp;&amp;</span></span>
<span class="line"><span class="token comment"># Download and verify the binary&#39;s signature file</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--silent</span> <span class="token parameter variable">--location</span> <span class="token string">&quot;https://download.influxdata.com/influxdb/releases/v2.7.12/influxdb2-2.7.12_linux_amd64.tar.gz.asc&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> gpg <span class="token parameter variable">--verify</span> - influxdb2-2.7.12_linux_amd64.tar.gz <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;InfluxData Package Signing Key &lt;support@influxdata.com&gt;&#39;</span></span>
<span class="line"><span class="token comment"># arm64</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--silent</span> <span class="token parameter variable">--location</span> https://repos.influxdata.com/influxdata-archive.key <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> gpg <span class="token parameter variable">--import</span> - <span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;InfluxData Package Signing Key &lt;support@influxdata.com&gt;&#39;</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">&amp;&amp;</span></span>
<span class="line"><span class="token comment"># Download and verify the binary&#39;s signature file</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--silent</span> <span class="token parameter variable">--location</span> <span class="token string">&quot;https://download.influxdata.com/influxdb/releases/v2.7.12/influxdb2-2.7.12_linux_arm64.tar.gz.asc&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator">|</span> gpg <span class="token parameter variable">--verify</span> - influxdb2-2.7.12_linux_arm64.tar.gz <span class="token punctuation">\\</span></span>
<span class="line"><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token string">&#39;InfluxData Package Signing Key &lt;support@influxdata.com&gt;&#39;</span></span>
<span class="line"><span class="token comment"># 安装成功输出如下</span></span>
<span class="line">gpg: Good signature from <span class="token string">&quot;InfluxData Package Signing Key &lt;support@influxdata.com&gt;&quot;</span> <span class="token punctuation">[</span>unknown<span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line"><span class="token comment"># 解压缩</span></span>
<span class="line"><span class="token function">tar</span> xvzf ./influxdb2-2.7.12_linux_amd64.tar.gz</span>
<span class="line"><span class="token function">tar</span> xvzf ./influxdb2-2.7.12_linux_arm64.tar.gz</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 提取可执行文件到$PATH中</span></span>
<span class="line"><span class="token function">sudo</span> <span class="token function">cp</span> ./influxdb2-2.7.12/usr/bin/influxd /usr/local/bin/</span>
<span class="line"><span class="token function">sudo</span> <span class="token function">cp</span> ./influxdb2-2.7.12/usr/bin/influxd /usr/local/bin/</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 启动命令 ./influxdb2-2.7.12/usr/bin/influxd</span></span>
<span class="line">influxd</span>
<span class="line"></span>
<span class="line"><span class="token comment"># 启动携带参数</span></span>
<span class="line">influxd --http-bind-address<span class="token operator">=</span>:8086 --reporting-disabled</span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="使用介绍" tabindex="-1"><a class="header-anchor" href="#使用介绍"><span>使用介绍</span></a></h2><p>InfluxDB数据库将时间序列数据存储在<code>buckets</code>和<code>measurements</code>中。一个<code>bucket(存储桶)</code>可以包含多个<code>measurements</code>。<code>measurement</code>包含多个<code>tags</code>和<code>fields</code>。</p><ul><li><strong>Bucket</strong>：存储时间序列数据的命名位置。一个存储桶可以包含多个测量值 。 <ul><li><strong>Measurement</strong>：时间序列数据的逻辑分组。给定测量中的所有点(points)都应具有相同的标签 。一个测量包含多个标签和字段 。 <ul><li><strong>Tags</strong>：值不同但不经常更改的键值对。标签用于存储每个点的元数据，例如，用于标识数据源的东西，如主机、位置、站点等。</li><li><strong>Fields</strong>：值随时间变化的键值对，例如：温度、压力、股票价格等。</li><li><strong>Timestamp</strong>：与数据关联的时间戳。当存储在磁盘上并进行查询时，所有数据都按时间排序。</li><li><strong>Point</strong>：单个数据记录，收集的数据tag keys、tag values、field keys和时间戳信息。</li><li><strong>Series</strong>：一组具有相同measurement、tag keys、tag values的points。</li></ul></li></ul></li></ul><p>和传统数据库概念对比</p><table><thead><tr><th>InfluxDB中的概念</th><th>传统关系数据库中的概念</th></tr></thead><tbody><tr><td>org</td><td>用户</td></tr><tr><td>Bucket</td><td>数据库</td></tr><tr><td>measurement</td><td>数据库中的表</td></tr><tr><td>point</td><td>表中的一行数据集</td></tr></tbody></table><figure><img src="http://47.101.155.205/image-20250607144203721.png" alt="image-20250607144203721" tabindex="0" loading="lazy"><figcaption>image-20250607144203721</figcaption></figure><h3 id="写数据" tabindex="-1"><a class="header-anchor" href="#写数据"><span>写数据</span></a></h3><p><strong>HTTP API写数据：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token comment"># 配置环境变量</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">INFLUX_HOST</span><span class="token operator">=</span><span class="token operator">&lt;</span>ip+port<span class="token operator">&gt;</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">INFLUX_ORG</span><span class="token operator">=</span><span class="token operator">&lt;</span>org<span class="token operator">&gt;</span></span>
<span class="line"><span class="token builtin class-name">export</span> <span class="token assign-left variable">INFLUX_TOKEN</span><span class="token operator">=</span><span class="token operator">&lt;</span>token<span class="token operator">&gt;</span></span>
<span class="line"><span class="token comment"># precision 表示时间戳精度，默认ns</span></span>
<span class="line"><span class="token comment"># home 表示 measurement</span></span>
<span class="line"><span class="token comment"># room=Kitchen temp=21.0 表示tags</span></span>
<span class="line"><span class="token comment"># co=0i 表示fields</span></span>
<span class="line"><span class="token comment"># 1641024000 表示时间戳</span></span>
<span class="line"><span class="token function">curl</span> <span class="token parameter variable">--request</span> POST <span class="token punctuation">\\</span></span>
<span class="line"><span class="token string">&quot;<span class="token variable">$INFLUX_HOST</span>/api/v2/write?org=<span class="token variable">$INFLUX_ORG</span>&amp;bucket=&lt;database&gt;&amp;precision=s&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--header</span> <span class="token string">&quot;Authorization: Token <span class="token variable">$INFLUX_TOKEN</span>&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--header</span> <span class="token string">&quot;Content-Type: text/plain; charset=utf-8&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--header</span> <span class="token string">&quot;Accept: application/json&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  --data-binary <span class="token string">&quot;</span>
<span class="line">home,room=Living\\ Room temp=21.1,hum=35.9,co=0i 1641024000</span>
<span class="line">home,room=Kitchen temp=21.0,hum=35.9,co=0i 1641024000</span>
<span class="line">&quot;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="查数据" tabindex="-1"><a class="header-anchor" href="#查数据"><span>查数据</span></a></h3><p>InfluxQL查询语法：</p><ul><li>SELECT：指定要查询的标签和属性；</li><li>FROM：指定查询的<code>measurement</code>；</li><li>WHERE：可根据属性、标签、时间筛选数据。</li></ul><div class="language-sql" data-highlighter="prismjs" data-ext="sql" data-title="sql"><pre><code><span class="line"><span class="token keyword">SELECT</span> co<span class="token punctuation">,</span>hum<span class="token punctuation">,</span><span class="token keyword">temp</span><span class="token punctuation">,</span>room <span class="token keyword">FROM</span> <span class="token string">&quot;get-started&quot;</span><span class="token punctuation">.</span>autogen<span class="token punctuation">.</span>home </span>
<span class="line"><span class="token keyword">WHERE</span> <span class="token keyword">time</span> <span class="token operator">&gt;=</span> <span class="token string">&#39;2022-01-01T08:00:00Z&#39;</span> <span class="token operator">AND</span> <span class="token keyword">time</span> <span class="token operator">&lt;=</span> <span class="token string">&#39;2022-01-01T20:00:00Z&#39;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><p><strong>HTTP API查数据：</strong></p><div class="language-bash line-numbers-mode" data-highlighter="prismjs" data-ext="sh" data-title="sh"><pre><code><span class="line"><span class="token function">curl</span> <span class="token parameter variable">--request</span> POST <span class="token punctuation">\\</span></span>
<span class="line"><span class="token string">&quot;<span class="token variable">$INFLUX_HOST</span>/api/v2/query?org=<span class="token variable">$INFLUX_ORG</span>&amp;bucket=get-started&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--header</span> <span class="token string">&quot;Authorization: Token <span class="token variable">$INFLUX_TOKEN</span>&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--header</span> <span class="token string">&quot;Content-Type: application/vnd.flux&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--header</span> <span class="token string">&quot;Accept: application/csv&quot;</span> <span class="token punctuation">\\</span></span>
<span class="line">  <span class="token parameter variable">--data</span> <span class="token string">&#39;from(bucket: &quot;get-started&quot;)</span>
<span class="line">    |&gt; range(start: 2022-01-01T08:00:00Z, stop: 2022-01-01T20:00:01Z)</span>
<span class="line">    |&gt; filter(fn: (r) =&gt; r._measurement == &quot;home&quot;)</span>
<span class="line">    |&gt; filter(fn: (r) =&gt; r._field== &quot;co&quot; or r._field == &quot;hum&quot; or r._field == &quot;temp&quot;)</span>
<span class="line">  &#39;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,31)]))}const o=n(t,[["render",p],["__file","InfluxDB.html.vue"]]),r=JSON.parse('{"path":"/database/InfluxDB.html","title":"InfluxDB","lang":"zh-CN","frontmatter":{},"headers":[{"level":2,"title":"安装","slug":"安装","link":"#安装","children":[{"level":3,"title":"Linux","slug":"linux","link":"#linux","children":[]}]},{"level":2,"title":"使用介绍","slug":"使用介绍","link":"#使用介绍","children":[{"level":3,"title":"写数据","slug":"写数据","link":"#写数据","children":[]},{"level":3,"title":"查数据","slug":"查数据","link":"#查数据","children":[]}]}],"git":{"updatedTime":1749284118000,"contributors":[{"name":"oycm","username":"oycm","email":"1164864987@qq.com","commits":1,"url":"https://github.com/oycm"}]},"filePathRelative":"database/InfluxDB.md"}');export{o as comp,r as data};
