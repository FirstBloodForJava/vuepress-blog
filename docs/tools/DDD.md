# 领域驱动设计

领域驱动设计(DDD，Domain-Driven Design)是一种**软件开发方法论**，由 Eric Evans 在他的经典著作《Domain-Driven Design: Tackling Complexity in the Heart of Software》一书中提出（2003 年）。核心理念：**以领域模型为核心推动软件设计与开发。**



## 领域模型模式

目前在企业级应用开发中，业务逻辑的组织方式主要是**事务脚本模式**。事务脚本按照业务处理的过程组织业务逻辑。

典型的事务脚本模式就是Controller-> Service -> Dao这样的程序设计模式。Controller封装用户请求，根据请求参数构造数据对象调用Service，Service中包含大量的业务逻辑代码，完成对数据的处理，期间可能需要通过Dao从数据库中获取数据，或者将数据写入数据库中。

事务脚本模式中Service、Dao这些对象只有方法，没有成员变量，方法调用时传递的对象没有方法（或者只有一些get和set），因此事务脚本模式又被称为贫血模式。



**领域模型模式**与事务脚本模式不同，领域模式下，业务逻辑围绕领域模型设计。

**领域**：业务知识和活动的集合，是系统要解决的问题空间。例如：银行的账户系统、支付系统等。

**模型**：对领域中业务概念的抽象，是开发团队对领域的共同理解。模型是用来沟通的工具，也是代码实现的基础。

**限界上下文(Bounded Context)**：对业务领域范围的描述，对于系统实现而言，相当于一个子系统或者一个子模块。

**通用语言(Ubiquitous Language)**：开发人员、领域专家、测试人员共享的一套业务语言，贯穿文档、设计和代码，使沟通无歧义。

**聚合(Aggregate)**：具有一致性边界的对象集合，一个聚合有一个根(Aggregate Root)，外部只能通过根访问内部对象。例如：订单聚合根为订单，内部有订单项、地址等。

**实体(Entity)与值对象(Value Object)**：实体是有唯一标识、生命周期，如用户、订单；值对象是无唯一标识，关注属性，如金额、地址。

**领域服务(Domain Service)**：不属于某个实体或值对象的行为，仍然属于领域逻辑。例如转账行为：涉及两个账户，不宜放在某一个账户对象中。

**应用服务(Application Service)**：协调多个领域对象完成一次业务，处理事务、权限、调用外部服务等。



## 分层架构

1. **接口层**：示、REST等
2. **应用层**：协调任务、事务等
3. **领域层**：核心模型、规则
4. **基础设施层**：数据库、消息中间件等